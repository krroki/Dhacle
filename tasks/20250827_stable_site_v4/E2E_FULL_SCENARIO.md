/sc:test --e2e --validate
"전체 사용자 여정 E2E 테스트"

# 🎬 Dhacle 전체 E2E 시나리오

⚠️ → 상단 '최우선 프로젝트 특화 규칙' 필수 확인

## 🎯 핵심 목표
**"신규 사용자가 회원가입부터 모든 기능을 사용할 수 있는가?"**

---

## 📋 사전 준비

```bash
# 1. 포트 정리 (이전 프로세스 종료)
netstat -ano | findstr :3000
taskkill /F /PID [프로세스ID]

# 2. 개발 서버 실행
npm run dev

# 3. 브라우저 준비
- Chrome 시크릿 모드
- DevTools 열기 (F12)
- Console & Network 탭

# 4. 테스트 데이터
- 로그인: "🧪 테스트 로그인" 버튼 사용
- 닉네임: 테스트유저123
- 카페 URL: https://cafe.naver.com/dinohighclass
- 테스트 카드: 4242 4242 4242 4242
```

---

## 🔄 신규 사용자 전체 여정 (10분)

### Step 1: 첫 방문 (0:00)
```markdown
1. localhost:3000 접속
   - [ ] 메인 페이지 로드 (3초 이내)
   - [ ] Console 에러 0개
   - [ ] 서비스 소개 표시

2. "시작하기" 클릭
   - [ ] 로그인 페이지로 이동
   - [ ] OAuth 옵션 표시
```

### Step 2: 테스트 로그인 (0:30)
```markdown
1. "🧪 테스트 로그인 (localhost 전용)" 클릭
   - [ ] 회색 버튼이 표시됨 (개발 모드)
   - [ ] 클릭 시 자동 로그인
   - [ ] 테스트 계정 생성 또는 로그인

2. 프로필 자동 생성
   - [ ] /mypage/profile 리다이렉트
   - [ ] 기본 프로필 표시
   - [ ] 랜덤 닉네임 생성됨
```

### Step 3: 프로필 설정 (1:00)
```markdown
1. "프로필 편집" 클릭
   - [ ] 편집 모드 전환
   
2. 정보 입력
   - [ ] 닉네임: "테스트유저123"
   - [ ] 작업 유형: "프리랜서"
   - [ ] 소개: "안녕하세요"
   
3. 프로필 이미지
   - [ ] 이미지 선택
   - [ ] 미리보기 표시
   - [ ] 업로드 성공
   
4. "저장" 클릭
   - [ ] "프로필이 업데이트되었습니다" 토스트
   - [ ] DB 저장 확인
```

### Step 4: 네이버 카페 인증 (2:00)
```markdown
1. "네이버 카페 인증" 섹션
   - [ ] 인증 폼 표시
   
2. 정보 입력
   - [ ] URL: https://cafe.naver.com/dinohighclass
   - [ ] 닉네임: "TestUser"
   
3. "인증 요청" 클릭
   - [ ] API 호출 (Network 탭)
   - [ ] 200 OK 응답
   - [ ] "인증 요청이 접수되었습니다" 토스트
   
4. DB 확인
   - [ ] profiles.cafe_member_url 저장됨
   - [ ] naver_cafe_verified = false
```

### Step 5: YouTube Lens 사용 (3:00)
```markdown
1. /tools/youtube-lens 접속
   - [ ] 페이지 로드
   - [ ] 검색창 표시
   
2. "프로그래밍" 검색
   - [ ] Enter 키 또는 "검색" 클릭
   - [ ] 로딩 스피너
   - [ ] 결과 리스트 (5개 이상)
   
3. 첫 번째 채널 클릭
   - [ ] 채널 정보 표시
   - [ ] 구독자 수, 비디오 수
   - [ ] "분석 시작" 버튼
   
4. 알림 규칙 설정
   - [ ] "알림 설정" 클릭
   - [ ] 메트릭: "구독자 변화"
   - [ ] 조건: "> 1000"
   - [ ] "규칙 추가" 클릭
   - [ ] 규칙 목록에 표시
   
5. 즐겨찾기 추가
   - [ ] ⭐ 클릭
   - [ ] 즐겨찾기 탭 확인
```

### Step 6: 유료 기능 구매 (5:00)
```markdown
1. /pricing 접속
   - [ ] 상품 목록 표시
   - [ ] 베이직/프로/엔터프라이즈
   
2. "프로" 선택
   - [ ] "구매하기" 클릭
   - [ ] 결제 페이지 이동
   
3. 쿠폰 적용
   - [ ] 쿠폰 코드: "WELCOME50"
   - [ ] "적용" 클릭
   - [ ] 50% 할인 표시
   - [ ] 금액 재계산
   
4. 결제 정보
   - [ ] 카드번호: 4242 4242 4242 4242
   - [ ] 유효기간: 12/34
   - [ ] CVC: 123
   
5. "결제하기" 클릭
   - [ ] 결제 처리 중...
   - [ ] 성공 페이지
   - [ ] 주문 번호 표시
```

### Step 7: 수익 인증 작성 (7:00)
```markdown
1. /revenue-proof/create 접속
   - [ ] 작성 폼 표시
   
2. 정보 입력
   - [ ] 제목: "2025년 8월 수익"
   - [ ] 금액: 5,000,000원
   - [ ] 설명: "YouTube 수익"
   
3. 이미지 업로드
   - [ ] 스크린샷 선택
   - [ ] 미리보기 표시
   
4. "저장" 클릭
   - [ ] 저장 성공
   - [ ] 상세 페이지 이동
   
5. "공유" 클릭
   - [ ] 공유 링크 생성
   - [ ] 클립보드 복사
```

### Step 8: 설정 변경 (9:00)
```markdown
1. 다크 모드
   - [ ] 테마 토글 클릭
   - [ ] 다크 모드 적용
   - [ ] 모든 페이지 확인
   
2. 언어 변경
   - [ ] 언어 드롭다운
   - [ ] "English" 선택
   - [ ] UI 텍스트 변경
   
3. 알림 설정
   - [ ] 🔔 클릭
   - [ ] 알림 목록
   - [ ] 설정 페이지
```

### Step 9: 로그아웃 (10:00)
```markdown
1. 프로필 메뉴
   - [ ] 아바타 클릭
   - [ ] 드롭다운 표시
   
2. "로그아웃" 클릭
   - [ ] 세션 종료
   - [ ] 메인 페이지 리다이렉트
   - [ ] 로그인 버튼 표시
```

---

## 🔍 기존 사용자 시나리오 (5분)

### 빠른 체크
```markdown
1. 로그인
   - [ ] 이전 계정으로 로그인
   - [ ] 세션 복구
   
2. 데이터 확인
   - [ ] 프로필 정보 유지
   - [ ] YouTube Lens 즐겨찾기
   - [ ] 알림 규칙 활성
   - [ ] 주문 내역
   
3. 주요 기능
   - [ ] YouTube 검색
   - [ ] 수익 인증 목록
   - [ ] 결제 내역
```

---

## 👨‍💼 관리자 시나리오 (3분)

### 관리 기능
```markdown
1. 관리자 로그인
   - [ ] /admin 접속
   - [ ] 권한 확인
   
2. 네이버 카페 승인
   - [ ] 인증 요청 목록
   - [ ] "승인" 버튼
   - [ ] DB 업데이트
   
3. 통계 확인
   - [ ] 사용자 수
   - [ ] 결제 현황
   - [ ] 활동 로그
```

---

## ⚠️ 에러 시나리오

### 필수 테스트
```markdown
1. 네트워크 에러
   - [ ] 오프라인 상태
   - [ ] 에러 메시지 표시
   - [ ] 재시도 버튼
   
2. 잘못된 입력
   - [ ] 빈 필드 제출
   - [ ] 검증 메시지
   - [ ] 폼 하이라이트
   
3. 권한 없음
   - [ ] 비로그인 상태로 /mypage
   - [ ] 로그인 페이지 리다이렉트
   
4. 결제 실패
   - [ ] 잘못된 카드 정보
   - [ ] 에러 처리
   - [ ] 재시도 가능
```

---

## ✅ 최종 체크리스트

### 성능 기준
- [ ] 페이지 로드: < 3초
- [ ] API 응답: < 500ms
- [ ] 에러율: < 0.1%

### 기능 완성도
- [ ] 모든 버튼 작동
- [ ] 모든 폼 제출 가능
- [ ] 모든 페이지 접근 가능
- [ ] 모든 API 정상 응답

### 사용자 경험
- [ ] Console 에러 0개
- [ ] 직관적인 UI
- [ ] 명확한 피드백
- [ ] 일관된 동작

### 증거 수집
- [ ] 전체 여정 녹화
- [ ] 각 단계 스크린샷
- [ ] Network 로그
- [ ] DB 데이터

---

## 🚀 자동화 (선택사항)

### Playwright 테스트
```typescript
// tests/e2e/full-journey.spec.ts
import { test, expect } from '@playwright/test';

test('신규 사용자 전체 여정', async ({ page }) => {
  // 1. 메인 페이지
  await page.goto('http://localhost:3000');
  await expect(page).toHaveTitle(/Dhacle/);
  
  // 2. 로그인
  await page.click('text=시작하기');
  // OAuth 처리...
  
  // 3. 프로필 설정
  await page.fill('input[name="username"]', '테스트유저123');
  await page.click('button:text("저장")');
  
  // ... 전체 시나리오
});
```

### 실행
```bash
npx playwright test
npx playwright test --ui  # UI 모드
npx playwright test --debug  # 디버그
```

---

## 🎯 성공 기준

```yaml
E2E_완료:
  신규_사용자: 100% 완주
  기존_사용자: 100% 작동
  관리자: 모든 기능 작동
  에러_처리: 우아한 실패
  
증거:
  - 10분 전체 여정 영상
  - 각 단계 스크린샷
  - 0개 Console 에러
  - 100% 기능 작동
```

---

## 🚨 테스트 종료 후 필수

```bash
# 1. 서버 종료
Ctrl + C

# 2. 포트 확인
netstat -ano | findstr :300

# 3. 남은 프로세스 강제 종료
taskkill /F /PID [프로세스ID]

# ⚠️ 3000-3010 포트 모두 확인하고 정리!
```

---

*전체 E2E 시나리오*
*목표: 실제 사용 가능 검증*
*시간: 10분 수동, 1분 자동*
*중요: 테스트 후 반드시 서버 종료!*