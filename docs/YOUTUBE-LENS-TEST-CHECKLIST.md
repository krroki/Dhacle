# YouTube Lens 테스트 체크리스트

## 📋 테스트 전 준비사항

### 1. 환경 변수 설정 확인
```bash
# .env.local 파일에 다음 변수들이 설정되어 있는지 확인
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your-client-secret
YOUTUBE_API_KEY=AIzaSy-your-api-key
ENCRYPTION_KEY=32자 이상의 암호화 키
```

### 2. 데이터베이스 마이그레이션 확인
```sql
-- Supabase SQL Editor에서 실행
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name IN ('user_api_keys', 'youtube_favorites', 'youtube_search_history', 'api_usage');
```

### 3. Google Cloud Console 설정 확인
- [ ] YouTube Data API v3 활성화
- [ ] OAuth 2.0 클라이언트 ID 생성
- [ ] 승인된 리디렉션 URI: `http://localhost:3000/api/youtube/auth/callback`
- [ ] API 키 생성 및 제한 설정

---

## 🧪 테스트 시나리오

### 1. 환경 변수 미설정 시나리오
**목적**: 환경 변수가 없을 때 적절한 안내가 표시되는지 확인

1. [ ] .env.local 파일의 YouTube 관련 변수를 임시로 제거
2. [ ] 개발 서버 재시작 (`npm run dev`)
3. [ ] `/tools/youtube-lens` 페이지 접속
4. [ ] **예상 결과**: SetupGuide 컴포넌트가 표시되고 누락된 변수 목록이 표시됨
5. [ ] 설정 가이드의 각 탭이 정상적으로 작동하는지 확인

### 2. OAuth 로그인 플로우
**목적**: Google OAuth 인증이 정상 작동하는지 확인

1. [ ] 환경 변수 모두 설정 후 서버 재시작
2. [ ] YouTube Lens 페이지에서 "Google 로그인" 버튼 클릭
3. [ ] Google 계정 선택 화면이 표시되는지 확인
4. [ ] 계정 선택 및 권한 승인
5. [ ] **예상 결과**: `/tools/youtube-lens?auth=success`로 리디렉션
6. [ ] 성공 토스트 메시지 표시 확인
7. [ ] 로그인된 사용자 이메일이 상단에 표시되는지 확인

### 3. OAuth 인증 실패 시나리오
**목적**: 인증 실패 시 적절한 에러 처리 확인

#### 3.1 사용자가 권한 거부
1. [ ] Google 로그인 시도
2. [ ] 권한 요청 화면에서 "취소" 클릭
3. [ ] **예상 결과**: "Google 로그인이 취소되었습니다" 토스트 표시

#### 3.2 잘못된 환경 변수
1. [ ] GOOGLE_CLIENT_SECRET을 잘못된 값으로 변경
2. [ ] 로그인 시도
3. [ ] **예상 결과**: "OAuth 초기화에 실패했습니다" 에러 메시지

### 4. YouTube 검색 기능
**목적**: 검색이 정상 작동하고 결과가 표시되는지 확인

1. [ ] 로그인 완료 후 검색바에 키워드 입력 (예: "쇼츠 만들기")
2. [ ] 검색 버튼 클릭 또는 Enter 키 입력
3. [ ] **예상 결과**: 
   - 로딩 상태 표시
   - 검색 결과가 VideoGrid에 표시
   - 각 비디오 카드에 썸네일, 제목, 채널명 표시

### 5. API 할당량 관리
**목적**: API 사용량이 정확히 추적되는지 확인

1. [ ] 검색 실행 전 QuotaStatus 컴포넌트의 사용량 확인
2. [ ] 검색 실행
3. [ ] QuotaStatus가 업데이트되는지 확인
4. [ ] **예상 결과**: 
   - used 값 증가
   - remaining 값 감소
   - percentage 업데이트
   - searchCount 증가

### 6. 즐겨찾기 기능 (구현 시)
**목적**: 즐겨찾기 추가/제거가 정상 작동하는지 확인

1. [ ] 검색 결과에서 비디오 카드의 하트 아이콘 클릭
2. [ ] 즐겨찾기 탭으로 이동
3. [ ] **예상 결과**: 즐겨찾기한 영상이 표시됨
4. [ ] 즐겨찾기 제거 테스트

### 7. 검색 기록
**목적**: 검색 기록이 저장되고 표시되는지 확인

1. [ ] 여러 검색어로 검색 수행
2. [ ] 검색 기록 탭 클릭
3. [ ] **예상 결과**: 검색했던 키워드들이 시간 순으로 표시
4. [ ] "다시 검색" 버튼 클릭 시 해당 검색어로 검색 실행

### 8. 토큰 갱신
**목적**: Access Token 만료 시 자동 갱신되는지 확인

1. [ ] 데이터베이스에서 token_expires_at을 과거 시간으로 수정
2. [ ] YouTube Lens 페이지 새로고침
3. [ ] **예상 결과**: 자동으로 토큰이 갱신되고 정상 작동

### 9. 에러 처리
**목적**: 다양한 에러 상황에서 적절한 메시지가 표시되는지 확인

#### 9.1 네트워크 오류
1. [ ] 개발자 도구에서 네트워크를 오프라인으로 설정
2. [ ] 검색 시도
3. [ ] **예상 결과**: "네트워크 오류가 발생했습니다" 메시지

#### 9.2 할당량 초과
1. [ ] api_usage 테이블의 units_used를 9999로 설정
2. [ ] 검색 시도
3. [ ] **예상 결과**: "YouTube API 일일 할당량을 초과했습니다" 메시지

### 10. 반응형 디자인
**목적**: 모바일/태블릿에서도 정상 작동하는지 확인

1. [ ] 개발자 도구에서 모바일 뷰로 전환
2. [ ] 모든 UI 요소가 적절히 표시되는지 확인
3. [ ] 터치 인터랙션이 작동하는지 확인

---

## 🔍 성능 테스트

### 메트릭 측정
1. [ ] 초기 페이지 로드 시간 < 3초
2. [ ] 검색 응답 시간 < 2초
3. [ ] 이미지 레이지 로딩 작동 확인
4. [ ] 메모리 누수 없음 (개발자 도구 Performance 탭)

---

## 🛡️ 보안 테스트

1. [ ] 환경 변수가 클라이언트에 노출되지 않는지 확인
   - 브라우저 개발자 도구에서 GOOGLE_CLIENT_SECRET 검색
   - Network 탭에서 응답 확인
2. [ ] CSRF 토큰이 정상 작동하는지 확인
3. [ ] API 키가 암호화되어 저장되는지 DB 확인
4. [ ] XSS 공격 시도 (검색어에 스크립트 입력)

---

## ✅ 테스트 완료 체크리스트

- [ ] 모든 환경 변수 설정 시나리오 통과
- [ ] OAuth 로그인/로그아웃 정상 작동
- [ ] 검색 기능 정상 작동
- [ ] API 할당량 추적 정상 작동
- [ ] 에러 처리 메시지 적절히 표시
- [ ] 반응형 디자인 정상 작동
- [ ] 성능 기준 충족
- [ ] 보안 테스트 통과

---

## 📝 테스트 결과 기록

| 테스트 항목 | 상태 | 이슈 | 비고 |
|------------|------|------|------|
| 환경 변수 체크 | ⏳ | - | - |
| OAuth 로그인 | ⏳ | - | - |
| YouTube 검색 | ⏳ | - | - |
| API 할당량 | ⏳ | - | - |
| 에러 처리 | ⏳ | - | - |
| 반응형 디자인 | ⏳ | - | - |
| 성능 | ⏳ | - | - |
| 보안 | ⏳ | - | - |

---

*테스트 일자: 2025-01-14*
*테스터: _____________*