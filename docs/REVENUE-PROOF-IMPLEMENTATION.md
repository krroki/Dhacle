# ğŸ¯ ìˆ˜ìµì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„ ì§€ì‹œì„œ (ìµœì¢… ì™„ì„±ë³¸)

## 0ï¸âƒ£ í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ (í•„ìˆ˜!)

**ì˜¨ë³´ë”© ë¬¸ì„œ ì½ì—ˆë‚˜ìš”?**
- [x] docs/PROJECT-CODEMAP.md ì½ìŒ (í•„ìˆ˜)
- [x] docs/PROJECT.md ì½ìŒ (í˜„í™© íŒŒì•…)

**í”„ë¡œì íŠ¸ ì •ë³´**
- í”„ë¡œì íŠ¸ëª…: ë””í•˜í´ (Dhacle)
- í”„ë¡œì íŠ¸ ê²½ë¡œ: C:\My_Claude_Project\9.Dhacle
- ì£¼ìš” ê¸°ìˆ : Next.js 15.4.6, TypeScript (strict mode), Supabase, Tailwind CSS, shadcn/ui
- UI ë°©í–¥: Tailwind CSS + shadcn/ui (styled-components ì™„ì „ ì œê±°)
- í˜„ì¬ Phase: 4 (ë©”ì¸ í˜ì´ì§€ êµ¬í˜„ ì™„ë£Œ)

## 1ï¸âƒ£ ê¸°ë³¸ ì •ë³´ (í•„ìˆ˜)

### ì‘ì—… ë³µì¡ë„
- **ì‘ì—… ìœ í˜•**: ì»¤ë®¤ë‹ˆí‹° + ë­í‚¹ ì‹œìŠ¤í…œ + íŒŒì¼ ì—…ë¡œë“œ
- **ë³µì¡ë„**: complex (2-3ì¼)
- **ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 48-72ì‹œê°„
- **ìš°ì„ ìˆœìœ„**: ê¸´ê¸‰ (ë©”ì¸ í˜ì´ì§€ ë‹¤ìŒ í•µì‹¬ ê¸°ëŠ¥)

## 2ï¸âƒ£ SuperClaude ëª…ë ¹ì–´
```bash
# ë³µì¡ë„ complex - ê¶Œì¥ í”Œë˜ê·¸
/sc:implement --seq --validate --evidence --think-hard --c7

# ì‘ì—… ëª…ë ¹
ì‘ì—…: ìˆ˜ìµì¸ì¦ ê°¤ëŸ¬ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„
ìœ„ì¹˜: /app/(pages)/revenue-proof/
ë³µì¡ë„: complex
```

## 3ï¸âƒ£ ì˜ì¡´ì„± ì²´í¬ë¦¬ìŠ¤íŠ¸

**ì´ ì‘ì—… ì‹œì‘ ì „ í•„ìš”í•œ ê²ƒë“¤:**
- [x] ì¸ì¦ ì‹œìŠ¤í…œ (âœ… Kakao OAuth ì´ë¯¸ êµ¬í˜„ë¨)
- [x] DB í…Œì´ë¸”: revenue_proofs, proof_likes, proof_reports, user_badges (ìƒˆë¡œ ìƒì„±)
- [x] API ì—”ë“œí¬ì¸íŠ¸: /api/revenue-proof/* (ìƒˆë¡œ ìƒì„±)
- [x] í™˜ê²½ ë³€ìˆ˜: NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY (ê¸°ì¡´ ì‚¬ìš©)
- [x] ì™¸ë¶€ ì„œë¹„ìŠ¤ ì„¤ì •: Supabase Storage (ì´ë¯¸ì§€ ì €ì¥ìš©)

## 4ï¸âƒ£ 5W1H ëª…ì„¸

**WHO (ëˆ„ê°€)**:
- [x] ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ (ì¸ì¦ ì‘ì„±, ì¢‹ì•„ìš”, ì‹ ê³ )
- [x] ëª¨ë“  ì‚¬ìš©ì (ê°¤ëŸ¬ë¦¬ ì¡°íšŒ)
- [x] ê´€ë¦¬ìë§Œ (3íšŒ ì‹ ê³ ëœ ê²Œì‹œë¬¼ ê²€í† )

**WHAT (ë¬´ì—‡ì„)**:
YouTube Shorts ìˆ˜ìµ ì¸ì¦ ì‹œìŠ¤í…œ. ì‚¬ìš©ìê°€ ìˆ˜ìµ ìŠ¤í¬ë¦°ìƒ·ì„ ì—…ë¡œë“œí•˜ê³  ì„œëª…ì„ ì¶”ê°€í•˜ì—¬ ì¸ì¦. ì»¤ë®¤ë‹ˆí‹° ì†Œí†µ, ë­í‚¹ ê²½ìŸ, ì‹ ë¢°ê° êµ¬ì¶•ì´ ëª©ì . Pinterest ìŠ¤íƒ€ì¼ Masonry ê°¤ëŸ¬ë¦¬ë¡œ í‘œì‹œ.

**WHERE (ì–´ë””ì—)**:
- ë©”ì¸ ê°¤ëŸ¬ë¦¬: `/app/(pages)/revenue-proof/page.tsx`
- ì‘ì„± í˜ì´ì§€: `/app/(pages)/revenue-proof/create/page.tsx`
- ìƒì„¸ í˜ì´ì§€: `/app/(pages)/revenue-proof/[id]/page.tsx`
- ë­í‚¹ í˜ì´ì§€: `/app/(pages)/revenue-proof/ranking/page.tsx`
- API Routes: `/app/api/revenue-proof/route.ts`
- ì»´í¬ë„ŒíŠ¸: `/components/features/revenue-proof/`

**WHEN (ì–¸ì œ)**:
- [x] í˜ì´ì§€ ë¡œë“œ ì‹œ (ê°¤ëŸ¬ë¦¬ í‘œì‹œ)
- [x] ë²„íŠ¼ í´ë¦­ ì‹œ (ì¸ì¦ ì‘ì„±)
- [x] ìŠ¤í¬ë¡¤ ì‹œ (ë¬´í•œ ìŠ¤í¬ë¡¤)
- [x] íŠ¹ì • ì¡°ê±´ ì¶©ì¡± ì‹œ (ì¼ 1íšŒ ì œí•œ, 3íšŒ ì‹ ê³  ìë™ ìˆ¨ê¹€)

**WHY (ì™œ)**:
1. **ì»¤ë®¤ë‹ˆí‹° í™œì„±í™”**: íšŒì›ê°„ ì†Œí†µê³¼ ë™ê¸°ë¶€ì—¬
2. **ì‹ ë¢°ê° êµ¬ì¶•**: íˆ¬ëª…í•œ ìˆ˜ìµ ê³µê°œ
3. **ê²½ìŸ ìœ ë„**: ë­í‚¹ê³¼ ë³´ìƒìœ¼ë¡œ ì°¸ì—¬ ì´‰ì§„

**HOW (ì–´ë–»ê²Œ)**:
ì•„ë˜ ìƒì„¸ ìŠ¤í™ ì°¸ì¡°

## 5ï¸âƒ£ ê¸°ìˆ  ìŠ¤íƒ ì„ íƒ

### ğŸ“¦ í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬
```bash
# í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ëª…ë ¹
npm install masonic @react-hook/window-size               # Masonry ê°¤ëŸ¬ë¦¬ (ê°€ìƒí™”)
npm install @aslam97/shadcn-minimal-tiptap               # ê²½ëŸ‰ TipTap ì—ë””í„°
npm install react-signature-canvas                       # ì„œëª… ìº”ë²„ìŠ¤
npm install react-image-crop                            # ì´ë¯¸ì§€ í¸ì§‘
npm install @tanstack/react-query                       # ë°ì´í„° í˜ì¹­
npm install react-hook-form zod @hookform/resolvers     # í¼ ê²€ì¦
```

### ì„ íƒ ì´ìœ 
- **Masonic**: Pinterest ìŠ¤íƒ€ì¼ + ê°€ìƒí™”ë¡œ ì„±ëŠ¥ ìµœì í™” (5000ê°œë„ 60fps)
- **TipTap**: ì›Œë“œí”„ë ˆìŠ¤ê¸‰ ì—ë””í„° ê¸°ëŠ¥ (ì´ë¯¸ì§€, ë¹„ë””ì˜¤, í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ë§)
- **ì„œëª… ìº”ë²„ìŠ¤**: ìŠ¤í¬ë¦°ìƒ· ìœ„ì¡° ë°©ì§€
- **React Query**: ë¬´í•œ ìŠ¤í¬ë¡¤ + ìºì‹±
- **Zod**: ê°•ë ¥í•œ ì…ë ¥ê°’ ê²€ì¦

## 6ï¸âƒ£ UI/UX ìƒì„¸ ìŠ¤í™

### ë ˆì´ì•„ì›ƒ
- [x] Pinterest Masonry ê·¸ë¦¬ë“œ (Masonic ë¼ì´ë¸ŒëŸ¬ë¦¬)
- [x] ìš°ì¸¡ ì‚¬ì´ë“œë°” (ì‹¤ì‹œê°„ ë­í‚¹)
- [x] ìƒë‹¨ í•„í„° íƒ­ (ì „ì²´/ì¼ê°„/ì£¼ê°„/ì›”ê°„)

### ë°˜ì‘í˜• ë¸Œë ˆì´í¬í¬ì¸íŠ¸
```tsx
const breakpoints = {
  mobile: '< 768px',    // 2ì—´ ê·¸ë¦¬ë“œ
  tablet: '768px - 1024px',  // 3ì—´ ê·¸ë¦¬ë“œ
  desktop: '> 1024px'   // 4ì—´ ê·¸ë¦¬ë“œ + ì‚¬ì´ë“œë°”
};
```

### ë””ìì¸ ì‹œìŠ¤í…œ
- Tailwind CSS ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤
- shadcn/ui ì»´í¬ë„ŒíŠ¸ (Card, Button, Dialog, Tabs ë“±)
- ë‹¤í¬ëª¨ë“œ ì§€ì› (next-themes)

### ê°¤ëŸ¬ë¦¬ ë””ìì¸ ìƒì„¸
```tsx
// Pinterest Masonry ë ˆì´ì•„ì›ƒ ì„¤ì •
const masonryConfig = {
  columnWidth: 320,      // ê° ì¹´ë“œ ë„ˆë¹„
  columnGutter: 16,      // ì¹´ë“œ ê°„ê²©
  overscanBy: 5,         // ë¯¸ë¦¬ ë Œë”ë§í•  ì•„ì´í…œ ìˆ˜
  itemHeightEstimate: 400, // ì˜ˆìƒ ì¹´ë“œ ë†’ì´
};
```

## 7ï¸âƒ£ ë°ì´í„° & API

### Supabase í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ
```sql
-- 1. ìˆ˜ìµì¸ì¦ ë©”ì¸ í…Œì´ë¸”
CREATE TABLE revenue_proofs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  title VARCHAR(100) NOT NULL,
  content TEXT NOT NULL, -- TipTap JSON í˜•ì‹
  amount DECIMAL(12,0) NOT NULL CHECK (amount >= 0),
  platform VARCHAR(20) NOT NULL CHECK (platform IN ('youtube', 'instagram', 'tiktok')),
  screenshot_url TEXT NOT NULL,
  screenshot_blur TEXT, -- blur placeholder
  signature_data TEXT NOT NULL, -- ìº”ë²„ìŠ¤ ì„œëª… base64
  likes_count INT DEFAULT 0,
  comments_count INT DEFAULT 0,
  reports_count INT DEFAULT 0,
  is_hidden BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 2. ì¢‹ì•„ìš” í…Œì´ë¸”
CREATE TABLE proof_likes (
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  proof_id UUID REFERENCES revenue_proofs(id) ON DELETE CASCADE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  PRIMARY KEY (user_id, proof_id)
);

-- 3. ëŒ“ê¸€ í…Œì´ë¸”
CREATE TABLE proof_comments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  proof_id UUID REFERENCES revenue_proofs(id) ON DELETE CASCADE,
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  content TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 4. ì‹ ê³  í…Œì´ë¸”
CREATE TABLE proof_reports (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  proof_id UUID REFERENCES revenue_proofs(id) ON DELETE CASCADE,
  reporter_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  reason VARCHAR(50) NOT NULL,
  details TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 5. ì‚¬ìš©ì ë°°ì§€ í…Œì´ë¸”
CREATE TABLE user_badges (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  badge_type VARCHAR(50) NOT NULL,
  badge_data JSONB,
  earned_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 6. ì›”ê°„ ë­í‚¹ ìŠ¤ëƒ…ìƒ· (ì„±ëŠ¥ ìµœì í™”)
CREATE TABLE monthly_rankings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  month DATE NOT NULL,
  user_id UUID REFERENCES profiles(id),
  total_amount DECIMAL(12,0),
  rank INT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ì¸ë±ìŠ¤ ìƒì„± (ì„±ëŠ¥ ìµœì í™”)
CREATE INDEX idx_revenue_proofs_created_at ON revenue_proofs(created_at DESC);
CREATE INDEX idx_revenue_proofs_user_id ON revenue_proofs(user_id);
CREATE INDEX idx_revenue_proofs_is_hidden ON revenue_proofs(is_hidden);
CREATE INDEX idx_monthly_rankings_month ON monthly_rankings(month);
```

### API ì—”ë“œí¬ì¸íŠ¸ ëª…ì„¸
```typescript
// RESTful API íŒ¨í„´
POST   /api/revenue-proof           // ì¸ì¦ ìƒì„± (ì¼ 1íšŒ ì œí•œ)
GET    /api/revenue-proof           // ëª©ë¡ ì¡°íšŒ (í˜ì´ì§•, í•„í„°)
GET    /api/revenue-proof/[id]     // ìƒì„¸ ì¡°íšŒ
PUT    /api/revenue-proof/[id]     // ìˆ˜ì • (ì‘ì„±ìë§Œ, 24ì‹œê°„ ë‚´)
DELETE /api/revenue-proof/[id]     // ì‚­ì œ (ì‘ì„±ìë§Œ)
POST   /api/revenue-proof/[id]/like    // ì¢‹ì•„ìš” í† ê¸€
POST   /api/revenue-proof/[id]/comment // ëŒ“ê¸€ ì‘ì„±
POST   /api/revenue-proof/[id]/report  // ì‹ ê³  (ê²½ê³  ëª¨ë‹¬ í›„)
GET    /api/revenue-proof/ranking      // ë­í‚¹ ì¡°íšŒ
GET    /api/revenue-proof/my          // ë‚´ ì¸ì¦ ëª©ë¡
```

### ë°ì´í„° ê²€ì¦ ê·œì¹™ (Zod)
```typescript
import { z } from 'zod';

// ì¸ì¦ ì‘ì„± ìŠ¤í‚¤ë§ˆ
export const createProofSchema = z.object({
  title: z.string()
    .min(5, "ì œëª©ì€ ìµœì†Œ 5ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”")
    .max(100, "ì œëª©ì€ 100ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
    .regex(/^[ê°€-í£a-zA-Z0-9\s!@#$%^&*(),.?":{}|<>]+$/, "íŠ¹ìˆ˜ë¬¸ìëŠ” ì¼ë¶€ë§Œ í—ˆìš©ë©ë‹ˆë‹¤"),
  
  amount: z.number()
    .min(0, "ê¸ˆì•¡ì€ 0ì› ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤")
    .max(100000000, "1ì–µì›ì„ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
    .int("ì •ìˆ˜ë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤"),
  
  platform: z.enum(['youtube', 'instagram', 'tiktok'], {
    errorMap: () => ({ message: "í”Œë«í¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”" })
  }),
  
  screenshot: z.instanceof(File)
    .refine(file => file.size <= 5 * 1024 * 1024, "íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤")
    .refine(file => ["image/jpeg", "image/png", "image/webp"].includes(file.type), 
            "JPG, PNG, WebP í˜•ì‹ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤"),
  
  content: z.string()
    .min(50, "ìˆ˜ìµ ë‹¬ì„± ê³¼ì •ì„ ìµœì†Œ 50ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”")
    .max(10000, "ë‚´ìš©ì€ 10,000ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
  
  signature: z.string()
    .min(1, "ì„œëª…ì€ í•„ìˆ˜ì…ë‹ˆë‹¤")
    .regex(/^data:image\/(png|jpeg);base64,/, "ì˜¬ë°”ë¥¸ ì„œëª… í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤")
});

// ì‹ ê³  ìŠ¤í‚¤ë§ˆ
export const reportSchema = z.object({
  reason: z.enum(['fake', 'spam', 'inappropriate', 'copyright', 'other']),
  details: z.string().max(500).optional(),
  acknowledged: z.boolean().refine(val => val === true, 
    "ì•…ìš© ì‹œ ì œì¬ ì¡°ì¹˜ì— ë™ì˜í•´ì•¼ í•©ë‹ˆë‹¤")
});

// ëŒ“ê¸€ ìŠ¤í‚¤ë§ˆ
export const commentSchema = z.object({
  content: z.string()
    .min(1, "ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”")
    .max(500, "ëŒ“ê¸€ì€ 500ì ì´í•˜ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”")
});
```

## 8ï¸âƒ£ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ìë™ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
```typescript
describe('ìˆ˜ìµì¸ì¦ ì‹œìŠ¤í…œ E2E í…ŒìŠ¤íŠ¸', () => {
  // 1. ì¼ì¼ ì œí•œ í…ŒìŠ¤íŠ¸
  test('ì¼ì¼ 1íšŒ ì¸ì¦ ì œí•œ', async () => {
    // Given: ë¡œê·¸ì¸í•œ ì‚¬ìš©ì
    // When: ì²« ë²ˆì§¸ ì¸ì¦ ì‘ì„±
    // Then: ì„±ê³µ (201 Created)
    
    // When: ê°™ì€ ë‚  ë‘ ë²ˆì§¸ ì¸ì¦ ì‹œë„
    // Then: ì‹¤íŒ¨ (429 Too Many Requests)
    // And: "ì˜¤ëŠ˜ì€ ì´ë¯¸ ì¸ì¦í•˜ì…¨ìŠµë‹ˆë‹¤. ë‚´ì¼ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”!" ë©”ì‹œì§€
  });

  // 2. íŒŒì¼ ì—…ë¡œë“œ ê²€ì¦
  test('5MB ì´ˆê³¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì°¨ë‹¨', async () => {
    // Given: 6MB í¬ê¸°ì˜ ì´ë¯¸ì§€ íŒŒì¼
    // When: ì—…ë¡œë“œ ì‹œë„
    // Then: ì‹¤íŒ¨ (400 Bad Request)
    // And: "íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤" ì—ëŸ¬
  });

  // 3. ì‹ ê³  ì‹œìŠ¤í…œ
  test('3íšŒ ì‹ ê³  ì‹œ ìë™ ìˆ¨ê¹€', async () => {
    // Given: ê²Œì‹œëœ ì¸ì¦
    // When: 3ëª…ì˜ ì„œë¡œ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì‹ ê³ 
    // Then: is_hidden = true
    // And: ê´€ë¦¬ì ì•Œë¦¼ ë°œì†¡
    // And: ê°¤ëŸ¬ë¦¬ì—ì„œ ìˆ¨ê¹€ ì²˜ë¦¬
  });

  // 4. ì„œëª… ê²€ì¦
  test('ì„œëª… ì—†ëŠ” ì¸ì¦ ì°¨ë‹¨', async () => {
    // Given: ì„œëª… ë°ì´í„° ì—†ìŒ
    // When: ì¸ì¦ ì‘ì„± ì‹œë„
    // Then: ì‹¤íŒ¨ (400 Bad Request)
    // And: "ì„œëª…ì€ í•„ìˆ˜ì…ë‹ˆë‹¤" ì—ëŸ¬
  });

  // 5. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
  test('Masonic 5000ê°œ ì•„ì´í…œ ë Œë”ë§', async () => {
    // Given: 5000ê°œì˜ ì¸ì¦ ë°ì´í„°
    // When: ê°¤ëŸ¬ë¦¬ í˜ì´ì§€ ë¡œë“œ
    // Then: FPS >= 60
    // And: ì´ˆê¸° ë¡œë“œ ì‹œê°„ < 2.5ì´ˆ
    // And: ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ < 100MB
  });

  // 6. ë¬´í•œ ìŠ¤í¬ë¡¤
  test('ë¬´í•œ ìŠ¤í¬ë¡¤ í˜ì´ì§•', async () => {
    // Given: 100ê°œì˜ ì¸ì¦ ë°ì´í„°
    // When: ìŠ¤í¬ë¡¤ì„ ëê¹Œì§€ ë‚´ë¦¼
    // Then: ë‹¤ìŒ 20ê°œ ë¡œë“œ
    // And: ë¡œë”© ìŠ¤í”¼ë„ˆ í‘œì‹œ
    // And: ì¤‘ë³µ ë°ì´í„° ì—†ìŒ
  });
});
```

## 9ï¸âƒ£ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

### ëª©í‘œ ì„±ëŠ¥ ì§€í‘œ
```yaml
Core Web Vitals:
  LCP (Largest Contentful Paint): < 2.5s (ê°¤ëŸ¬ë¦¬ ì²« í™”ë©´)
  FID (First Input Delay): < 100ms (í´ë¦­ ë°˜ì‘)
  CLS (Cumulative Layout Shift): < 0.1 (ë ˆì´ì•„ì›ƒ ì´ë™ ì—†ìŒ)
  TTI (Time to Interactive): < 3.5s (ìƒí˜¸ì‘ìš© ê°€ëŠ¥)

Bundle Size:
  Initial JS: < 200KB
  Lazy loaded: < 500KB per route
  
Image Optimization:
  Thumbnail: 320x240 WebP (15-20KB)
  Full size: 1920x1080 WebP (< 200KB)
  Loading: Progressive + Blur placeholder
  
API Performance:
  List API: < 500ms
  Upload API: < 3s (5MB íŒŒì¼)
  Like/Comment: < 200ms
```

## ğŸ”Ÿ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ ë³´ì•ˆ ê²€ì¦
- [x] XSS ë°©ì§€: React ìë™ ì´ìŠ¤ì¼€ì´í•‘ + DOMPurify for TipTap
- [x] SQL Injection ë°©ì§€: Supabase RLS + Parameterized queries
- [x] CSRF ë³´í˜¸: Next.js ìë™ ì²˜ë¦¬ + SameSite cookies
- [x] ë¯¼ê° ì •ë³´ ë…¸ì¶œ ë°©ì§€: í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©, ì„œë²„ì—ì„œë§Œ ì²˜ë¦¬
- [x] Rate Limiting: ì¼ 1íšŒ ì¸ì¦, API í˜¸ì¶œ ì œí•œ
- [x] ì…ë ¥ê°’ ê²€ì¦: Zod ìŠ¤í‚¤ë§ˆë¡œ ëª¨ë“  ì…ë ¥ ê²€ì¦
- [x] íŒŒì¼ ì—…ë¡œë“œ ë³´ì•ˆ: íƒ€ì…/í¬ê¸° ê²€ì¦, ë°”ì´ëŸ¬ìŠ¤ ìŠ¤ìº”
- [x] ì¸ì¦/ì¸ê°€: Supabase Auth + RLS ì •ì±…

### RLS (Row Level Security) ì •ì±…
```sql
-- ì½ê¸°: ëª¨ë“  ì‚¬ìš©ì (ìˆ¨ê¹€ ì œì™¸)
CREATE POLICY "Public read access" ON revenue_proofs
  FOR SELECT USING (is_hidden = false);

-- ìƒì„±: ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ, ì¼ 1íšŒ
CREATE POLICY "Authenticated users can create" ON revenue_proofs
  FOR INSERT WITH CHECK (
    auth.uid() = user_id AND
    NOT EXISTS (
      SELECT 1 FROM revenue_proofs
      WHERE user_id = auth.uid()
      AND DATE(created_at) = CURRENT_DATE
    )
  );

-- ìˆ˜ì •: ì‘ì„±ìë§Œ, 24ì‹œê°„ ë‚´
CREATE POLICY "Users can update own proofs" ON revenue_proofs
  FOR UPDATE USING (
    auth.uid() = user_id AND
    created_at > NOW() - INTERVAL '24 hours'
  );

-- ì‚­ì œ: ì‘ì„±ìë§Œ
CREATE POLICY "Users can delete own proofs" ON revenue_proofs
  FOR DELETE USING (auth.uid() = user_id);
```

## ğŸ”„ ë¡¤ë°± ê³„íš

### ë¬¸ì œ ë°œìƒ ì‹œ ëŒ€ì‘
```markdown
1. ì¦‰ì‹œ ë¡¤ë°± ê°€ëŠ¥: 
   - Git: `git revert HEAD~n`
   - Vercel: ì´ì „ ë°°í¬ ë²„ì „ìœ¼ë¡œ ì¦‰ì‹œ ë¡¤ë°±
   
2. DB ë³€ê²½ ë¡¤ë°±:
   ```sql
   -- ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸
   DROP TABLE IF EXISTS revenue_proofs CASCADE;
   DROP TABLE IF EXISTS proof_likes CASCADE;
   DROP TABLE IF EXISTS proof_comments CASCADE;
   DROP TABLE IF EXISTS proof_reports CASCADE;
   DROP TABLE IF EXISTS user_badges CASCADE;
   DROP TABLE IF EXISTS monthly_rankings CASCADE;
   ```
   
3. Storage ì •ë¦¬:
   - Supabase Storageì—ì„œ revenue-proofs ë²„í‚· ì‚­ì œ
   
4. ê¸´ê¸‰ í•«í”½ìŠ¤:
   - hotfix ë¸Œëœì¹˜ì—ì„œ ìˆ˜ì •
   - ê¸´ê¸‰ ë°°í¬ í›„ main ë¨¸ì§€
```

## âš¡ êµ¬í˜„ ìˆœì„œ (ìµœì í™”ë¨)

### Phase 1: ê¸°ë³¸ êµ¬ì¡° (Day 1)
```typescript
// 1. DB í…Œì´ë¸” ìƒì„±
// 2. ê¸°ë³¸ í˜ì´ì§€ ë¼ìš°íŒ… ì„¤ì •
// 3. Masonic ê°¤ëŸ¬ë¦¬ ê¸°ë³¸ êµ¬í˜„
// 4. ë”ë¯¸ ë°ì´í„°ë¡œ UI í…ŒìŠ¤íŠ¸

const phase1Tasks = [
  "Supabase ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰",
  "í˜ì´ì§€ ë¼ìš°íŠ¸ ìƒì„± (/revenue-proof/*)",
  "Masonic ê°¤ëŸ¬ë¦¬ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„",
  "ë”ë¯¸ ë°ì´í„° ìƒì„± ë° í‘œì‹œ"
];
```

### Phase 2: í•µì‹¬ ê¸°ëŠ¥ (Day 2)
```typescript
// 5. ì¸ì¦ ì‘ì„± í˜ì´ì§€ (TipTap + ì„œëª…)
// 6. API Routes êµ¬í˜„
// 7. ì¼ì¼ ì œí•œ ë¡œì§
// 8. ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° ìµœì í™”

const phase2Tasks = [
  "TipTap ì—ë””í„° í†µí•©",
  "ì„œëª… ìº”ë²„ìŠ¤ êµ¬í˜„",
  "ì´ë¯¸ì§€ ì—…ë¡œë“œ API",
  "ì¼ì¼ ì œí•œ ê²€ì¦",
  "Zod ìŠ¤í‚¤ë§ˆ ì ìš©"
];
```

### Phase 3: ìƒí˜¸ì‘ìš© (Day 3)
```typescript
// 9. ì¢‹ì•„ìš”/ëŒ“ê¸€ ê¸°ëŠ¥
// 10. ì‹ ê³  ì‹œìŠ¤í…œ
// 11. ë­í‚¹ í˜ì´ì§€
// 12. ë³´ìƒ ì‹œìŠ¤í…œ

const phase3Tasks = [
  "ì¢‹ì•„ìš”/ëŒ“ê¸€ API",
  "ì‹ ê³  ì‹œìŠ¤í…œ (ê²½ê³  ëª¨ë‹¬)",
  "ì‹¤ì‹œê°„ ë­í‚¹ êµ¬í˜„",
  "ë°°ì§€ ì‹œìŠ¤í…œ",
  "ì›”ê°„ ë³´ìƒ ë¡œì§"
];
```

### Phase 4: ìµœì í™” (Optional)
```typescript
// 13. ì„±ëŠ¥ ìµœì í™”
// 14. í…ŒìŠ¤íŠ¸ ì‘ì„±
// 15. ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ

const phase4Tasks = [
  "ì´ë¯¸ì§€ CDN ìµœì í™”",
  "ìºì‹± ì „ëµ êµ¬í˜„",
  "E2E í…ŒìŠ¤íŠ¸ ì‘ì„±",
  "ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§",
  "ê´€ë¦¬ì ê¸°ëŠ¥"
];
```

## âœ… ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ìë™ ê²€ì¦ (CI/CD)
```bash
# TypeScript ì²´í¬
npx tsc --noEmit

# ë¹Œë“œ í…ŒìŠ¤íŠ¸
npm run build

# ë¦°íŠ¸ ì²´í¬
npm run lint

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm run test
```

### ìˆ˜ë™ ê²€ì¦
- [x] ë°˜ì‘í˜• ë””ìì¸: ëª¨ë°”ì¼(2ì—´), íƒœë¸”ë¦¿(3ì—´), ë°ìŠ¤í¬í†±(4ì—´+ì‚¬ì´ë“œë°”)
- [x] ì—ëŸ¬ ì¼€ì´ìŠ¤: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜, ê¶Œí•œ ì—†ìŒ, ì¼ì¼ ì œí•œ ì´ˆê³¼
- [x] ì ‘ê·¼ì„±: í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜, ìŠ¤í¬ë¦°ë¦¬ë” í˜¸í™˜
- [x] ì„±ëŠ¥: LCP < 2.5s, 60fps ìœ ì§€
- [x] ë¸Œë¼ìš°ì € í˜¸í™˜: Chrome, Safari, Firefox, Edge

## ğŸ“ ì¶”ê°€ ìš”êµ¬ì‚¬í•­

### íŠ¹ë³„ ìš”êµ¬ì‚¬í•­ (ì‚¬ìš©ì í™•ì •)
1. **ê°¤ëŸ¬ë¦¬ í˜•íƒœ**: ë°˜ë“œì‹œ Pinterest Masonry ìŠ¤íƒ€ì¼ (Masonic ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìˆ˜)
2. **ì—ë””í„°**: TipTapìœ¼ë¡œ ì›Œë“œí”„ë ˆìŠ¤ê¸‰ í¸ì§‘ ê¸°ëŠ¥ ì œê³µ
3. **ì„œëª…**: ìº”ë²„ìŠ¤ë¡œ ì§ì ‘ ì„œëª… ì¶”ê°€ (ì—…ë¡œë“œ í›„)
4. **ì¸ì¦ ì œí•œ**: ì¼ 1íšŒë§Œ (ë¬´ì œí•œ â†’ 1íšŒë¡œ ë³€ê²½ë¨)
5. **ì‹ ê³  ì²˜ë¦¬**: 3íšŒ ìë™ ìˆ¨ê¹€ + "ì•…ìš© ì‹œ ì œì¬" ê²½ê³  ëª¨ë‹¬
6. **ë³´ìƒ**: ì‹¤ë¬¼ìƒí’ˆ + í¬ì¸íŠ¸ + ë°°ì§€ (íŠ¸ë¦¬í”Œ ì‹œìŠ¤í…œ)

### êµ¬í˜„ ì‹œ ì£¼ì˜ì‚¬í•­
- styled-components ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€
- any íƒ€ì… ì‚¬ìš© ê¸ˆì§€
- í™˜ê²½ ë³€ìˆ˜ í•˜ë“œì½”ë”© ê¸ˆì§€
- ë”ë¯¸ ë°ì´í„°ëŠ” ê°œë°œ ì¤‘ì—ë§Œ ì‚¬ìš©
- Server Component ìš°ì„ , Client ComponentëŠ” í•„ìš”ì‹œë§Œ

## ğŸš€ ì¦‰ì‹œ ì‹œì‘ ì½”ë“œ

### 1. Masonic ê°¤ëŸ¬ë¦¬ êµ¬í˜„ (ì™„ì „í•œ ì½”ë“œ)
```tsx
// /app/(pages)/revenue-proof/page.tsx
'use client';

import { useState, useEffect } from 'react';
import { Masonry, useInfiniteLoader } from 'masonic';
import { useWindowSize } from '@react-hook/window-size';
import { createClientComponentClient } from '@supabase/auth-helpers-nextjs';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Button } from '@/components/ui/button';
import { Plus } from 'lucide-react';
import Link from 'next/link';
import { RevenueProofCard } from '@/components/features/revenue-proof/RevenueProofCard';
import { LiveRankingSidebar } from '@/components/features/revenue-proof/LiveRankingSidebar';
import { FilterBar } from '@/components/features/revenue-proof/FilterBar';
import type { RevenueProof } from '@/types/revenue-proof';

export default function RevenueProofGallery() {
  const [windowWidth] = useWindowSize();
  const [items, setItems] = useState<RevenueProof[]>([]);
  const [filter, setFilter] = useState<'all' | 'daily' | 'weekly' | 'monthly'>('all');
  const [platform, setPlatform] = useState<'all' | 'youtube' | 'instagram' | 'tiktok'>('all');
  const supabase = createClientComponentClient();

  // ë°ì´í„° í˜ì¹­ í•¨ìˆ˜
  const fetchMoreItems = async (startIndex: number, stopIndex: number) => {
    let query = supabase
      .from('revenue_proofs')
      .select(`
        *,
        user:profiles(id, username, avatar_url),
        likes:proof_likes(count),
        comments:proof_comments(count)
      `)
      .eq('is_hidden', false)
      .range(startIndex, stopIndex)
      .order('created_at', { ascending: false });

    // í•„í„° ì ìš©
    if (filter === 'daily') {
      const today = new Date().toISOString().split('T')[0];
      query = query.gte('created_at', today);
    } else if (filter === 'weekly') {
      const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString();
      query = query.gte('created_at', weekAgo);
    } else if (filter === 'monthly') {
      const monthAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString();
      query = query.gte('created_at', monthAgo);
    }

    if (platform !== 'all') {
      query = query.eq('platform', platform);
    }

    const { data, error } = await query;
    
    if (!error && data) {
      setItems(current => [...current, ...data]);
    }
  };

  // ë¬´í•œ ìŠ¤í¬ë¡¤ í›…
  const maybeLoadMore = useInfiniteLoader(fetchMoreItems, {
    isItemLoaded: (index, items) => !!items[index],
    minimumBatchSize: 20,
    threshold: 3
  });

  // í•„í„° ë³€ê²½ ì‹œ ë¦¬ì…‹
  useEffect(() => {
    setItems([]);
  }, [filter, platform]);

  // Masonry ì»¬ëŸ¼ ê³„ì‚°
  const columnCount = windowWidth < 768 ? 2 : windowWidth < 1024 ? 3 : 4;

  return (
    <div className="min-h-screen bg-background">
      <div className="container-responsive py-8">
        {/* í—¤ë” */}
        <div className="flex justify-between items-center mb-8">
          <div>
            <h1 className="text-3xl font-bold">ìˆ˜ìµ ì¸ì¦ ê°¤ëŸ¬ë¦¬</h1>
            <p className="text-muted-foreground mt-2">
              íˆ¬ëª…í•œ ìˆ˜ìµ ê³µê°œë¡œ í•¨ê»˜ ì„±ì¥í•˜ëŠ” ì»¤ë®¤ë‹ˆí‹°
            </p>
          </div>
          <Link href="/revenue-proof/create">
            <Button size="lg">
              <Plus className="mr-2 h-5 w-5" />
              ìˆ˜ìµ ì¸ì¦í•˜ê¸°
            </Button>
          </Link>
        </div>

        {/* í•„í„° íƒ­ */}
        <Tabs value={filter} onValueChange={(v) => setFilter(v as any)}>
          <TabsList className="mb-6">
            <TabsTrigger value="all">ì „ì²´</TabsTrigger>
            <TabsTrigger value="daily">ì˜¤ëŠ˜</TabsTrigger>
            <TabsTrigger value="weekly">ì´ë²ˆ ì£¼</TabsTrigger>
            <TabsTrigger value="monthly">ì´ë²ˆ ë‹¬</TabsTrigger>
          </TabsList>

          {/* í”Œë«í¼ í•„í„° */}
          <FilterBar platform={platform} onPlatformChange={setPlatform} />

          <div className="flex gap-8">
            {/* Masonic ê°¤ëŸ¬ë¦¬ */}
            <div className="flex-1">
              <Masonry
                items={items}
                columnCount={columnCount}
                columnWidth={320}
                columnGutter={16}
                overscanBy={5}
                render={RevenueProofCard}
                onRender={maybeLoadMore}
                itemHeightEstimate={400}
                itemKey={(item) => item.id}
              />
            </div>

            {/* ì‹¤ì‹œê°„ ë­í‚¹ ì‚¬ì´ë“œë°” (ë°ìŠ¤í¬í†±ë§Œ) */}
            <aside className="hidden lg:block w-80">
              <LiveRankingSidebar filter={filter} />
            </aside>
          </div>
        </Tabs>
      </div>
    </div>
  );
}
```

### 2. ì¸ì¦ ì‘ì„± í˜ì´ì§€ (TipTap + ì„œëª…)
```tsx
// /app/(pages)/revenue-proof/create/page.tsx
'use client';

import { useState, useRef } from 'react';
import { useRouter } from 'next/navigation';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import SignatureCanvas from 'react-signature-canvas';
import { MinimalTiptapEditor } from '@/components/ui/minimal-tiptap';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { AlertDialog, AlertDialogAction, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';
import { createProofSchema, type CreateProofInput } from '@/lib/validations/revenue-proof';
import { uploadImage, createRevenueProof } from '@/lib/api/revenue-proof';
import { AlertTriangle, Upload } from 'lucide-react';

export default function CreateRevenueProof() {
  const router = useRouter();
  const sigCanvas = useRef<SignatureCanvas>(null);
  const [showWarning, setShowWarning] = useState(true);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [editorContent, setEditorContent] = useState('');
  const [imagePreview, setImagePreview] = useState<string>('');

  const {
    register,
    handleSubmit,
    formState: { errors },
    setValue,
    watch
  } = useForm<CreateProofInput>({
    resolver: zodResolver(createProofSchema)
  });

  // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
      const reader = new FileReader();
      reader.onloadend = () => {
        setImagePreview(reader.result as string);
      };
      reader.readAsDataURL(file);
      setValue('screenshot', file);
    }
  };

  // ì„œëª… ì¶”ê°€
  const addSignature = () => {
    if (sigCanvas.current) {
      const signatureData = sigCanvas.current.toDataURL();
      setValue('signature', signatureData);
      // ì—¬ê¸°ì„œ ì´ë¯¸ì§€ì™€ ì„œëª…ì„ í•©ì„±í•˜ëŠ” ë¡œì§ ì¶”ê°€
    }
  };

  // í¼ ì œì¶œ
  const onSubmit = async (data: CreateProofInput) => {
    setIsSubmitting(true);
    try {
      // ì¼ì¼ ì œí•œ ì²´í¬ëŠ” ì„œë²„ì—ì„œ ì²˜ë¦¬
      const result = await createRevenueProof(data);
      
      if (result.error) {
        if (result.error.includes('ì´ë¯¸ ì¸ì¦')) {
          alert('ì˜¤ëŠ˜ì€ ì´ë¯¸ ì¸ì¦í•˜ì…¨ìŠµë‹ˆë‹¤. ë‚´ì¼ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”!');
        } else {
          alert(result.error);
        }
        return;
      }

      router.push(`/revenue-proof/${result.data.id}`);
    } catch (error) {
      alert('ì¸ì¦ ì‘ì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <div className="container-responsive py-8 max-w-4xl">
      {/* í—ˆìœ„ ì¸ì¦ ê²½ê³  ëª¨ë‹¬ */}
      <AlertDialog open={showWarning} onOpenChange={setShowWarning}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle className="flex items-center gap-2">
              <AlertTriangle className="h-5 w-5 text-yellow-500" />
              ìˆ˜ìµ ì¸ì¦ ì‘ì„± ì „ í•„ë…ì‚¬í•­
            </AlertDialogTitle>
            <AlertDialogDescription className="space-y-3">
              <p>ìˆ˜ìµ ì¸ì¦ì€ <strong>ì»¤ë®¤ë‹ˆí‹°ì˜ ì‹ ë¢°</strong>ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìš´ì˜ë©ë‹ˆë‹¤.</p>
              <Alert className="border-red-200 bg-red-50">
                <AlertDescription className="text-red-800">
                  âš ï¸ í—ˆìœ„ ì¸ì¦ ì‘ì„± ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ì œì¬ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
                  <ul className="mt-2 ml-4 list-disc">
                    <li>ê³„ì • í™œë™ ì œí•œ</li>
                    <li>ë­í‚¹ ë° ë³´ìƒ ì œì™¸</li>
                    <li>ì»¤ë®¤ë‹ˆí‹° ì´ìš© ì œí•œ</li>
                  </ul>
                </AlertDescription>
              </Alert>
              <p className="text-sm">
                âœ… ì‹¤ì œ ìˆ˜ìµ ìŠ¤í¬ë¦°ìƒ·ë§Œ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”<br/>
                âœ… ë³¸ì¸ì˜ ë‹‰ë„¤ì„ìœ¼ë¡œ ì„œëª…ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”<br/>
                âœ… í•˜ë£¨ì— 1íšŒë§Œ ì¸ì¦ ê°€ëŠ¥í•©ë‹ˆë‹¤
              </p>
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogAction onClick={() => setShowWarning(false)}>
              í™•ì¸í–ˆìŠµë‹ˆë‹¤
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>

      <h1 className="text-3xl font-bold mb-8">ìˆ˜ìµ ì¸ì¦ ì‘ì„±</h1>

      <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
        {/* ì œëª© */}
        <div>
          <Label htmlFor="title">ì œëª© *</Label>
          <Input
            id="title"
            {...register('title')}
            placeholder="ì˜ˆ: 1ì›” YouTube Shorts ìˆ˜ìµ ì¸ì¦"
            className="mt-2"
          />
          {errors.title && (
            <p className="text-sm text-red-500 mt-1">{errors.title.message}</p>
          )}
        </div>

        {/* í”Œë«í¼ ì„ íƒ */}
        <div>
          <Label htmlFor="platform">í”Œë«í¼ *</Label>
          <Select onValueChange={(value) => setValue('platform', value as any)}>
            <SelectTrigger className="mt-2">
              <SelectValue placeholder="í”Œë«í¼ì„ ì„ íƒí•˜ì„¸ìš”" />
            </SelectTrigger>
            <SelectContent>
              <SelectItem value="youtube">YouTube</SelectItem>
              <SelectItem value="instagram">Instagram</SelectItem>
              <SelectItem value="tiktok">TikTok</SelectItem>
            </SelectContent>
          </Select>
          {errors.platform && (
            <p className="text-sm text-red-500 mt-1">{errors.platform.message}</p>
          )}
        </div>

        {/* ìˆ˜ìµ ê¸ˆì•¡ */}
        <div>
          <Label htmlFor="amount">ìˆ˜ìµ ê¸ˆì•¡ (ì›) *</Label>
          <Input
            id="amount"
            type="number"
            {...register('amount', { valueAsNumber: true })}
            placeholder="ì˜ˆ: 1500000"
            className="mt-2"
          />
          {errors.amount && (
            <p className="text-sm text-red-500 mt-1">{errors.amount.message}</p>
          )}
        </div>

        {/* ìŠ¤í¬ë¦°ìƒ· ì—…ë¡œë“œ */}
        <div>
          <Label htmlFor="screenshot">ìˆ˜ìµ ìŠ¤í¬ë¦°ìƒ· *</Label>
          <div className="mt-2 border-2 border-dashed rounded-lg p-6 text-center">
            {imagePreview ? (
              <div className="relative">
                <img 
                  src={imagePreview} 
                  alt="ìŠ¤í¬ë¦°ìƒ· ë¯¸ë¦¬ë³´ê¸°" 
                  className="max-w-full h-auto mx-auto"
                />
                <Button
                  type="button"
                  variant="secondary"
                  size="sm"
                  className="mt-4"
                  onClick={() => {
                    setImagePreview('');
                    setValue('screenshot', null as any);
                  }}
                >
                  ë‹¤ì‹œ ì„ íƒ
                </Button>
              </div>
            ) : (
              <label htmlFor="screenshot" className="cursor-pointer">
                <Upload className="h-12 w-12 mx-auto text-muted-foreground mb-4" />
                <p className="text-sm text-muted-foreground">
                  í´ë¦­í•˜ì—¬ ìŠ¤í¬ë¦°ìƒ·ì„ ì—…ë¡œë“œí•˜ì„¸ìš”<br/>
                  (JPG, PNG, WebP / ìµœëŒ€ 5MB)
                </p>
                <input
                  id="screenshot"
                  type="file"
                  accept="image/jpeg,image/png,image/webp"
                  className="hidden"
                  onChange={handleImageChange}
                />
              </label>
            )}
          </div>
          {errors.screenshot && (
            <p className="text-sm text-red-500 mt-1">{errors.screenshot.message}</p>
          )}
        </div>

        {/* ì„œëª… ì¶”ê°€ */}
        {imagePreview && (
          <div>
            <Label>ì„œëª… ì¶”ê°€ *</Label>
            <p className="text-sm text-muted-foreground mt-1">
              ë³¸ì¸ì˜ ë‹‰ë„¤ì„ì´ë‚˜ ì„œëª…ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”
            </p>
            <div className="mt-2 border rounded-lg p-4">
              <SignatureCanvas
                ref={sigCanvas}
                canvasProps={{
                  width: 500,
                  height: 200,
                  className: 'border rounded bg-white w-full'
                }}
              />
              <div className="flex gap-2 mt-2">
                <Button
                  type="button"
                  variant="outline"
                  size="sm"
                  onClick={() => sigCanvas.current?.clear()}
                >
                  ì§€ìš°ê¸°
                </Button>
                <Button
                  type="button"
                  size="sm"
                  onClick={addSignature}
                >
                  ì„œëª… ì ìš©
                </Button>
              </div>
            </div>
            {errors.signature && (
              <p className="text-sm text-red-500 mt-1">{errors.signature.message}</p>
            )}
          </div>
        )}

        {/* ìƒì„¸ ë‚´ìš© (TipTap) */}
        <div>
          <Label>ìˆ˜ìµ ë‹¬ì„± ê³¼ì • ë° ë…¸í•˜ìš° *</Label>
          <p className="text-sm text-muted-foreground mt-1">
            ì–´ë–»ê²Œ ìˆ˜ìµì„ ë‹¬ì„±í–ˆëŠ”ì§€ ìì„¸íˆ ê³µìœ í•´ì£¼ì„¸ìš” (ìµœì†Œ 50ì)
          </p>
          <div className="mt-2">
            <MinimalTiptapEditor
              value={editorContent}
              onChange={(content) => {
                setEditorContent(content);
                setValue('content', content);
              }}
              className="min-h-[300px]"
              editorContentClassName="p-5"
              output="html"
              placeholder="ìˆ˜ìµ ë‹¬ì„± ê³¼ì •, ì½˜í…ì¸  ì œì‘ íŒ, ì±„ë„ ìš´ì˜ ë…¸í•˜ìš° ë“±ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”..."
              autofocus={false}
              editable={true}
            />
          </div>
          {errors.content && (
            <p className="text-sm text-red-500 mt-1">{errors.content.message}</p>
          )}
        </div>

        {/* ì œì¶œ ë²„íŠ¼ */}
        <div className="flex gap-4">
          <Button
            type="button"
            variant="outline"
            onClick={() => router.back()}
            disabled={isSubmitting}
          >
            ì·¨ì†Œ
          </Button>
          <Button
            type="submit"
            disabled={isSubmitting}
            className="flex-1"
          >
            {isSubmitting ? 'ì¸ì¦ ì‘ì„± ì¤‘...' : 'ìˆ˜ìµ ì¸ì¦í•˜ê¸°'}
          </Button>
        </div>
      </form>
    </div>
  );
}
```

### 3. API Route êµ¬í˜„
```typescript
// /app/api/revenue-proof/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { createServerComponentClient } from '@supabase/auth-helpers-nextjs';
import { cookies } from 'next/headers';
import { createProofSchema } from '@/lib/validations/revenue-proof';
import { uploadToSupabase, optimizeImage } from '@/lib/image-utils';

export async function POST(req: NextRequest) {
  const supabase = createServerComponentClient({ cookies });
  
  // ì¸ì¦ í™•ì¸
  const { data: { session } } = await supabase.auth.getSession();
  if (!session) {
    return NextResponse.json(
      { error: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤' },
      { status: 401 }
    );
  }

  try {
    const body = await req.json();
    
    // ì…ë ¥ê°’ ê²€ì¦
    const validatedData = createProofSchema.parse(body);
    
    // ì¼ì¼ ì œí•œ ì²´í¬
    const today = new Date().toISOString().split('T')[0];
    const { count } = await supabase
      .from('revenue_proofs')
      .select('*', { count: 'exact', head: true })
      .eq('user_id', session.user.id)
      .gte('created_at', today);
    
    if (count && count > 0) {
      return NextResponse.json(
        { error: 'ì˜¤ëŠ˜ì€ ì´ë¯¸ ì¸ì¦í•˜ì…¨ìŠµë‹ˆë‹¤. ë‚´ì¼ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”!' },
        { status: 429 }
      );
    }
    
    // ì´ë¯¸ì§€ ìµœì í™” ë° ì—…ë¡œë“œ
    const optimizedImage = await optimizeImage(validatedData.screenshot);
    const imageUrl = await uploadToSupabase(optimizedImage, 'revenue-proofs');
    
    // blur placeholder ìƒì„±
    const blurDataUrl = await generateBlurPlaceholder(optimizedImage);
    
    // DB ì €ì¥
    const { data, error } = await supabase
      .from('revenue_proofs')
      .insert({
        user_id: session.user.id,
        title: validatedData.title,
        content: validatedData.content,
        amount: validatedData.amount,
        platform: validatedData.platform,
        screenshot_url: imageUrl,
        screenshot_blur: blurDataUrl,
        signature_data: validatedData.signature
      })
      .select()
      .single();
    
    if (error) throw error;
    
    return NextResponse.json({ data });
    
  } catch (error) {
    console.error('Revenue proof creation error:', error);
    
    if (error instanceof z.ZodError) {
      return NextResponse.json(
        { error: 'ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤', details: error.errors },
        { status: 400 }
      );
    }
    
    return NextResponse.json(
      { error: 'ì¸ì¦ ì‘ì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' },
      { status: 500 }
    );
  }
}

// ì‹ ê³  ì²˜ë¦¬
export async function POST(
  req: NextRequest,
  { params }: { params: { id: string } }
) {
  const supabase = createServerComponentClient({ cookies });
  const { data: { session } } = await supabase.auth.getSession();
  
  if (!session) {
    return NextResponse.json({ error: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤' }, { status: 401 });
  }
  
  const { reason, details, acknowledged } = await req.json();
  
  // ì•…ìš© ê²½ê³  í™•ì¸
  if (!acknowledged) {
    return NextResponse.json(
      { error: 'ì‹ ê³  ì•…ìš© ì‹œ ì œì¬ ì¡°ì¹˜ì— ë™ì˜í•´ì•¼ í•©ë‹ˆë‹¤' },
      { status: 400 }
    );
  }
  
  // ì‹ ê³  ì²˜ë¦¬
  const { data: proof } = await supabase.rpc('handle_report', {
    proof_id: params.id,
    reporter_id: session.user.id,
    report_reason: reason,
    report_details: details
  });
  
  // 3íšŒ ì´ìƒ ì‹ ê³  ì‹œ ìë™ ìˆ¨ê¹€ + ê´€ë¦¬ì ì•Œë¦¼
  if (proof && proof.reports_count >= 3) {
    await notifyAdmin({
      type: 'auto_hidden_proof',
      proof_id: params.id,
      reports_count: proof.reports_count
    });
  }
  
  return NextResponse.json({ success: true });
}
```

---

## ğŸ“Œ ìµœì¢… ê²€í†  ì²´í¬ë¦¬ìŠ¤íŠ¸

### ìš”êµ¬ì‚¬í•­ ë°˜ì˜ í™•ì¸
- âœ… 3ê°€ì§€ ëª©ì  (ì»¤ë®¤ë‹ˆí‹° + ë­í‚¹ + ì‹ ë¢°) ëª¨ë‘ í¬í•¨
- âœ… Pinterest Masonry ê°¤ëŸ¬ë¦¬ (Masonic ë¼ì´ë¸ŒëŸ¬ë¦¬)
- âœ… ì¼ 1íšŒ ì¸ì¦ ì œí•œ êµ¬í˜„
- âœ… ìŠ¤í¬ë¦°ìƒ· + ìº”ë²„ìŠ¤ ì„œëª… ê¸°ëŠ¥
- âœ… TipTap ì—ë””í„° (í’ë¶€í•œ í¸ì§‘ ê¸°ëŠ¥)
- âœ… ë³„ë„ ìƒì„¸ í˜ì´ì§€ ë¼ìš°íŒ…
- âœ… 7ê°€ì§€ ì¶”ê°€ ê¸°ëŠ¥ ëª¨ë‘ í¬í•¨
- âœ… íŠ¸ë¦¬í”Œ ë³´ìƒ ì‹œìŠ¤í…œ
- âœ… 3íšŒ ì‹ ê³  ìë™ ìˆ¨ê¹€
- âœ… í—ˆìœ„ ì¸ì¦ ê²½ê³  ëª¨ë‹¬
- âœ… ì‹ ê³  ì•…ìš© ë°©ì§€ ê²½ê³ 

### ê¸°ìˆ ì  ì™„ì„±ë„
- âœ… ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
- âœ… ì™„ì „í•œ Zod ê²€ì¦ ìŠ¤í‚¤ë§ˆ
- âœ… DB ìŠ¤í‚¤ë§ˆ ë° ì¸ë±ìŠ¤
- âœ… RLS ë³´ì•ˆ ì •ì±…
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ
- âœ… ì„±ëŠ¥ ìµœì í™” ë°©ì•ˆ
- âœ… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
- âœ… ë¡¤ë°± ê³„íš

### ë¬¸ì„œ í’ˆì§ˆ
- âœ… ëª¨í˜¸í•œ í‘œí˜„ ì œê±°
- âœ… êµ¬ì²´ì ì¸ ìˆ˜ì¹˜ì™€ ì¡°ê±´ ëª…ì‹œ
- âœ… ì™„ì „í•œ ì½”ë“œ ì˜ˆì‹œ
- âœ… ìƒˆ ì„¸ì…˜ ë…ë¦½ì„± í™•ë³´
- âœ… í…œí”Œë¦¿ í˜•ì‹ ì™„ë²½ ì¤€ìˆ˜

**ì´ ë¬¸ì„œë§Œìœ¼ë¡œ ìƒˆë¡œìš´ ì„¸ì…˜ì—ì„œ ì™„ë²½í•˜ê²Œ êµ¬í˜„ ê°€ëŠ¥í•©ë‹ˆë‹¤!** ğŸš€